syntax = "proto3";

package budget;

service BudgetService {
  rpc GetBudgets(GetBudgetsRequest) returns (GetBudgetsResponse);
  rpc GetBudget(GetBudgetRequest) returns (Budget);
  rpc CreateBudget(CreateBudgetRequest) returns (Budget);
  rpc UpdateBudget(UpdateBudgetRequest) returns (Budget);
  rpc DeleteBudget(DeleteBudgetRequest) returns (DeleteBudgetResponse);
  rpc GetBudgetForecast(GetBudgetForecastRequest) returns (BudgetForecast);
  rpc GetBudgetMonitoring(GetBudgetMonitoringRequest) returns (BudgetMonitoring);
}

message Budget {
  string id = 1;
  string project_id = 2;
  string project_name = 3;
  double total_amount = 4;
  double allocated_amount = 5;
  double remaining_amount = 6;
  string start_date = 7;
  string end_date = 8;
  string status = 9;
  repeated BudgetItem items = 10;
  string created_at = 11;
  string updated_at = 12;
}

message BudgetItem {
  string id = 1;
  string budget_id = 2;
  string category = 3;
  string description = 4;
  double amount = 5;
  double spent_amount = 6;
  string created_at = 7;
  string updated_at = 8;
}

message GetBudgetsRequest {
  int32 page = 1;
  int32 limit = 2;
  string sort_by = 3;
  string sort_order = 4;
  string search = 5;
  string status = 6;
}

message GetBudgetsResponse {
  repeated Budget budgets = 1;
  int32 total = 2;
  int32 page = 3;
  int32 limit = 4;
}

message GetBudgetRequest {
  string id = 1;
}

message CreateBudgetRequest {
  string project_id = 1;
  string project_name = 2;
  double total_amount = 3;
  string start_date = 4;
  string end_date = 5;
  repeated BudgetItemInput items = 6;
}

message BudgetItemInput {
  string category = 1;
  string description = 2;
  double amount = 3;
}

message UpdateBudgetRequest {
  string id = 1;
  string project_name = 2;
  double total_amount = 3;
  string start_date = 4;
  string end_date = 5;
  string status = 6;
  repeated BudgetItemUpdate items = 7;
}

message BudgetItemUpdate {
  string id = 1;
  string category = 2;
  string description = 3;
  double amount = 4;
  double spent_amount = 5;
}

message DeleteBudgetRequest {
  string id = 1;
}

message DeleteBudgetResponse {
  bool success = 1;
  string message = 2;
}

message GetBudgetForecastRequest {
  string project_id = 1;
  string start_date = 2;
  string end_date = 3;
}

message BudgetForecast {
  string project_id = 1;
  repeated ForecastPeriod periods = 2;
  double total_forecasted_amount = 3;
  double confidence_score = 4;
}

message ForecastPeriod {
  string period = 1;
  double forecasted_amount = 2;
  double actual_amount = 3;
  double variance = 4;
}

message GetBudgetMonitoringRequest {
  string project_id = 1;
}

message BudgetMonitoring {
  string project_id = 1;
  string project_name = 2;
  double total_budget = 3;
  double total_spent = 4;
  double burn_rate = 5;
  int32 days_remaining = 6;
  string projected_completion_date = 7;
  string budget_status = 8;
  repeated CategorySpending category_spending = 9;
  repeated MonthlySpending monthly_spending = 10;
}

message CategorySpending {
  string category = 1;
  double allocated = 2;
  double spent = 3;
  double remaining = 4;
  double percentage_used = 5;
}

message MonthlySpending {
  string month = 1;
  double planned = 2;
  double actual = 3;
  double variance = 4;
}